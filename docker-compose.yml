services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: world_model_agent_api
    env_file:
      - ${DEMO_ENV_FILE:-.env.demo.local}
    environment:
      WORLD_GATE_KEY: ${WORLD_GATE_KEY:-}
    ports:
      - "${PORT:-8001}:8001"
    command: uvicorn app:app --host 0.0.0.0 --port 8001 --workers 1
    healthcheck:
      test: ["CMD", "curl", "-fsS", "http://127.0.0.1:8001/"]
      interval: 15s
      timeout: 3s
      retries: 5
      start_period: 20s
    restart: unless-stopped
