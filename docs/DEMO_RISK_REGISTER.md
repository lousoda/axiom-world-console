# Demo Risk Register

This register tracks operational risks for hackathon demo readiness. It serves as a historical reference.

| ID | Risk | Trigger | Impact | Mitigation | Owner | Verification |
|---|---|---|---|---|---|---|
| R1 | Monad RPC timeout / instability | RPC slow or unreachable during live token-gated join | Demo interruption on `/join` | Run strict preflight before demo; keep 1-2 fresh tx hashes ready; keep local profile for rehearsal | Demo operator | `bash scripts/preflight_demo.sh .env.demo.live http://127.0.0.1:8011` |
| R2 | Reused tx hash returns `409` | Re-running strict flow with same tx hash | Join blocked in front of judges | Use a fresh tx hash per strict run; track used hashes in local file | Demo operator | `grep -n "<tx_hash>" .demo/used_tx_hashes.txt` |
| R3 | Wrong runtime mode (not single worker) | Manual server start without run script | In-memory state inconsistency risk | Start only via `scripts/run_demo.sh` (forces `--workers 1`) | Demo operator | `ps -ef | grep "uvicorn app:app"` |
| R4 | Chaotic concurrent writes | Multiple clients sending POST mutations in parallel | Non-deterministic demo behavior | One operator for mutating endpoints; observers use read-only endpoints | Demo team | Team runbook discipline |
| R5 | Determinism proof reports `MISMATCH` | Stale process, mixed profile, or concurrent writes during proof | Undermines determinism claim | Restart server; ensure single worker; rerun `scripts/determinism_proof.sh` after reset only | Demo operator | `result: MATCH` + identical hashes in `ARTIFACTS/determinism_proof_<timestamp>.json` |
| R6 | UI CORS / proxy misroute | Browser calls blocked when UI is on different origin | Judges cannot load data via UI | Host UI with `/api/*` rewrite to Fly API; smoke UI connect before demo | UI lead | `curl -I <ui-url>/api/world` returns `200` or UI "Validate" passes |
| R7 | Rate-limit noise under write bursts | Multiple parallel POST mutations (`/auto/tick`, `/join`, etc.) during demo | 429 responses look like failures or slow actions in front of judges; risk missing required state | Keep single operator for writes; avoid stress tests during pitch; if rate-limit enabled, keep concurrency low and watch for 5xx | Demo operator | `for i in $(seq 1 20); do curl -s -o /dev/null -w "%{http_code}\n" -X POST "http://127.0.0.1:8011/auto/tick?limit_agents=20" -H "X-World-Gate: $WORLD_GATE_KEY"; done | sort | uniq -c` (expect only 200/429) |
| R8 | Mixed demo profiles / env | Starting server with wrong `.env.demo.*` file or reusing shell env from previous profile | Unexpected RPC dependency or auth behavior; determinism proof may drift or fail | Start new shell per run; launch only via `scripts/run_demo.sh <env>`; avoid exporting live-only vars (e.g., `SMOKE_ENTRY_TX_HASH`) in local mode | Demo operator | `curl -s http://127.0.0.1:8011/debug/info | jq '.ALLOW_FREE_JOIN, .MONAD_RPC_URL'` matches chosen profile |
| R9 | State loss after restart (no persistence) | Restarting API/Fly machine without saving snapshot or running proof | Lose world snapshot and determinism artifacts; cannot show evidence to judges | Avoid restarts during demo; run `scripts/determinism_proof.sh` before restart; if reset needed, use `/persist/save` then `/persist/load` | Demo operator | `ls ARTIFACTS/determinism_proof_*.json` and `curl -s http://127.0.0.1:8011/persist/status` show artifacts/snapshot |
| R10 | Static UI build/redeploy fails | CI/CD error or missing env during `npm run build` | Public UI unavailable | Keep last good artifact; verify build locally before deploy; store build logs | UI lead | `npm run build` passes; artifact stored |
| R11 | CDN cache serves stale UI (wrong API origin) | Deploy without cache busting/version pin | UI points to old endpoint, CORS errors | Versioned filenames or `?v=<hash>`; purge CDN after deploy; validate endpoint in UI | UI lead | `Validate` hits intended API and returns 200 |
| R12 | UI configured to wrong API origin | Manual endpoint entry or bad default | UI 401/404 while API is healthy | Ship `/api` default with reverse proxy; show current endpoint in status bar | UI lead | UI status shows `/api`; health check 200 |
